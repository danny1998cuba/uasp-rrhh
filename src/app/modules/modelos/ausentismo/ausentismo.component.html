<app-title-banner title="Informe de Ausentismo" image_src="assets/images/models_banner.png"></app-title-banner>

<div class="card-body">

    <mat-horizontal-stepper linear="true" #stepper>
        <ng-template matStepperIcon="done">
            <fa-icon [icon]="faDone"></fa-icon>
        </ng-template>

        <mat-step [stepControl]="monthControl" [editable]="false" #monthStep>
            <ng-container *ngIf="!isLoading; else noData;">
                <ng-template matStepLabel>{{mes}}</ng-template>
                <app-month-picker (submitEvent)="obtainMonth($event)" #month></app-month-picker>
            </ng-container>
        </mat-step>

        <mat-step [editable]="false" #formStep>
            <ng-template matStepLabel>Entrada de datos</ng-template>
            <app-ausentismo-form (submitEvent)="loadinfo($event)" *ngIf="monthStep.completed" #form
                [mes]="selectedMonth">
            </app-ausentismo-form>
            <div class="flex-right">
                <button mat-button (click)="reset()">Volver al inicio</button>
            </div>
        </mat-step>

        <mat-step>
            <ng-template matStepLabel>Documento</ng-template>

            <ng-container *ngIf="!isLoading; else noData;">
                <ng-container *ngIf="file != ''; else noFile">
                    <app-pdf-viewer [src]="file" [downloadFileName]="'Ausentismo - ' + mes + '.pdf'">
                    </app-pdf-viewer>
                </ng-container>
            </ng-container>
            <br />

            <div class="flex-right">
                <button mat-button (click)="reset()">Volver al inicio</button>
            </div>
        </mat-step>
    </mat-horizontal-stepper>
</div>

<ng-template #noData>
    <app-loader></app-loader>
</ng-template>

<ng-template #noFile>
    <small class="text-danger">
        No se carg&oacute; el archivo
    </small>
</ng-template>